<div class="gradient-bg text-gray-100 min-h-screen flex overflow-hidden">
  <!-- Sidebar -->
  <div class="sidebar-bg w-64 min-h-screen fixed md:flex flex-col border-r border-gray-700 z-50" [ngClass]="{'hidden': !isSidebarOpen}">
    <div class="p-6 flex items-center space-x-3">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path d="M12 14l9-5-9-5-9 5 9 5z" />
        <path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222" />
      </svg>
      <span class="text-2xl font-bold text-gradient">EduTech</span>
    </div>
    
    <div class="flex-1 overflow-y-auto px-4 py-6">
      <!-- User Profile -->
      <div class="flex items-center space-x-4 p-4 mb-6 rounded-lg bg-gray-700 bg-opacity-50 animate__animated animate__fadeIn">
        <div class="relative">
          <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="Profile" class="w-12 h-12 rounded-full object-cover border-2 border-blue-500">
          <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-gray-800"></span>
        </div>
        <div>
          <h4 class="font-semibold">Marie Dupont</h4>
          <p class="text-sm text-gray-400">Étudiante</p>
        </div>
      </div>
      
      <!-- Course Progress -->
      <div class="p-4 bg-gray-700 bg-opacity-50 rounded-lg mb-6 animate__animated animate__fadeIn animate__delay-1s">
        <h4 class="font-medium mb-3 flex justify-between">
          <span>Progression du cours</span>
          <span class="text-blue-400">{{ courseProgress }}%</span>
        </h4>
        <div class="w-full bg-gray-600 rounded-full h-2">
          <div class="bg-blue-500 h-2 rounded-full" [style.width]="courseProgress + '%'"></div>
        </div>
        <p class="text-xs text-gray-400 mt-2">13/20 leçons complétées</p>
        
        <div class="mt-4 pt-4 border-t border-gray-600">
          <h4 class="font-medium mb-2">Maîtrise de JavaScript Moderne</h4>
          <p class="text-xs text-gray-400">Quiz Vidéo: Fonctions fléchées</p>
        </div>
      </div>
      
      <!-- Course Navigation -->
      <div class="space-y-2">
        <h4 class="font-medium px-4 py-2">Navigation du cours</h4>
        <a href="#" class="menu-item flex items-center space-x-3 px-4 py-3 rounded-lg" (click)="navigateTo('lesson')">
          <i class="fas fa-play-circle text-blue-400 w-5"></i>
          <span>Retour à la leçon</span>
        </a>
        <a href="#" class="menu-item flex items-center space-x-3 px-4 py-3 rounded-lg" (click)="navigateTo('modules')">
          <i class="fas fa-list-ol text-purple-400 w-5"></i>
          <span>Voir tous les modules</span>
        </a>
        <a href="#" class="menu-item flex items-center space-x-3 px-4 py-3 rounded-lg" (click)="navigateTo('resources')">
          <i class="fas fa-download text-green-400 w-5"></i>
          <span>Télécharger les ressources</span>
        </a>
        <a href="#" class="menu-item flex items-center space-x-3 px-4 py-3 rounded-lg" (click)="navigateTo('question')">
          <i class="fas fa-question-circle text-yellow-400 w-5"></i>
          <span>Poser une question</span>
        </a>
      </div>
    </div>
    
    <!-- Logout -->
    <div class="p-4 border-t border-gray-700 animate__animated animate__fadeIn animate__delay-2s">
      <a href="#" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-400 hover:text-white hover:bg-gray-700 transition-colors" (click)="navigateTo('logout')">
        <i class="fas fa-sign-out-alt w-5"></i>
        <span>Quitter le cours</span>
      </a>
    </div>
  </div>

  <!-- Mobile sidebar backdrop -->
  <div class="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden" [ngClass]="{'hidden': !isSidebarOpen}" (click)="toggleSidebar()"></div>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col overflow-hidden md:ml-64">
    <!-- Navbar -->
    <header class="bg-gray-800 bg-opacity-90 backdrop-filter backdrop-blur-lg border-b border-gray-700 z-40">
      <div class="flex items-center justify-between px-6 py-3">
        <button class="md:hidden text-gray-400 hover:text-white focus:outline-none" (click)="toggleSidebar()">
          <i class="fas fa-bars text-xl"></i>
        </button>
        
        <div class="flex-1 mx-4">
          <nav class="flex" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-2 text-sm">
              <li><a href="#" class="text-gray-400 hover:text-white" (click)="navigateTo('courses')">Mes cours</a></li>
              <li class="flex items-center">
                <span class="text-gray-600 mx-2">/</span>
                <a href="#" class="text-gray-400 hover:text-white" (click)="navigateTo('javascript')">JavaScript Moderne</a>
              </li>
              <li class="flex items-center">
                <span class="text-gray-600 mx-2">/</span>
                <a href="#" class="text-gray-400 hover:text-white" (click)="navigateTo('arrow-functions')">Fonctions fléchées</a>
              </li>
              <li class="flex items-center">
                <span class="text-gray-600 mx-2">/</span>
                <a href="#" class="text-blue-400">Quiz Vidéo</a>
              </li>
            </ol>
          </nav>
        </div>
        
        <div class="flex items-center space-x-4">
          <button class="text-gray-400 hover:text-white" (click)="openHelp()">
            <i class="fas fa-question-circle text-xl"></i>
          </button>
          <button class="text-gray-400 hover:text-white" (click)="openSettings()">
            <i class="fas fa-cog text-xl"></i>
          </button>
          <div class="relative">
            <button class="flex items-center space-x-2 focus:outline-none user-menu-button" (click)="toggleUserMenu()">
              <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="Profile" class="w-8 h-8 rounded-full border-2 border-blue-500">
            </button>
            <div class="absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 z-50 border border-gray-700 user-menu" [ngClass]="{'hidden': !isUserMenuOpen}">
              <a href="#" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700" (click)="navigateTo('account')">Mon compte</a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700" (click)="navigateTo('settings')">Paramètres</a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700" (click)="navigateTo('logout')">Déconnexion</a>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto p-6">
      <div class="quiz-video-container">
        <!-- Quiz Header -->
        <div class="flex items-center justify-between mb-8">
          <div>
            <span class="bg-blue-900 bg-opacity-50 text-blue-400 text-xs px-2 py-1 rounded">Module 3: ES6+</span>
            <h1 class="text-3xl font-bold mt-2">Quiz Vidéo: Fonctions fléchées</h1>
            <p class="text-gray-400 mt-1">Répondez aux questions pendant la lecture de la vidéo</p>
          </div>
          <div class="flex items-center">
            <div class="relative w-12 h-12 mr-3">
              <svg class="progress-ring w-12 h-12" width="48" height="48">
                <circle class="progress-ring-circle" stroke="#3B82F6" stroke-width="4" fill="transparent" r="20" cx="24" cy="24" [attr.stroke-dasharray]="circumference" [attr.stroke-dashoffset]="progressOffset"/>
              </svg>
              <span class="absolute inset-0 flex items-center justify-center text-sm font-bold">{{ currentQuestionIndex + 1 }}/{{ questions.length }}</span>
            </div>
            <div>
              <p class="text-sm text-gray-400">Progression</p>
              <p class="font-semibold">Question {{ currentQuestionIndex + 1 }} sur {{ questions.length }}</p>
            </div>
          </div>
        </div>
        
        <!-- Video Player with Quiz Integration -->
        <div class="video-container bg-black animate__animated animate__fadeIn mb-8" (mouseenter)="showVideoControls()" (mouseleave)="hideVideoControls()">
          <div class="relative aspect-video">
            <video #quizVideo class="w-full h-full" poster="https://images.unsplash.com/photo-1555066931-4365d14bab8c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80">
              <source src="#" type="video/mp4">
              Votre navigateur ne supporte pas la lecture de vidéos.
            </video>
            
            <div *ngFor="let marker of quizMarkers" class="video-quiz-marker" [style.left]="marker.position + '%'" [attr.data-question]="marker.question" (click)="showQuizPopup(marker.question)">
              <span>{{ marker.question }}</span>
            </div>
            
            <div class="video-controls absolute bottom-0 left-0 right-0 p-4 text-white" [ngClass]="{'opacity-0': !isVideoControlsVisible, 'opacity-100': isVideoControlsVisible}">
              <div class="progress-bar mb-3" (click)="seekVideo($event)">
                <div class="progress-bar-fill" [style.width]="videoProgress + '%'"></div>
              </div>
              <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                  <button class="control-btn play-pause" (click)="togglePlayPause()">
                    <i class="fas" [ngClass]="videoPlaying ? 'fa-pause' : 'fa-play'" class="text-xl"></i>
                  </button>
                  <button class="control-btn rewind" (click)="rewind()">
                    <i class="fas fa-undo text-lg"></i>
                  </button>
                  <button class="control-btn forward" (click)="forward()">
                    <i class="fas fa-redo text-lg"></i>
                  </button>
                  <div class="text-sm">
                    <span class="current-time">{{ currentTime | date:'mm:ss' }}</span> /
                    <span class="duration">{{ duration | date:'mm:ss' }}</span>
                  </div>
                </div>
                <div class="flex items-center space-x-4">
                  <div class="relative playback-speed">
                    <button class="control-btn speed-toggle" (click)="cyclePlaybackSpeed()">
                      <span class="speed-text">{{ playbackSpeed }}x</span>
                    </button>
                  </div>
                  <button class="control-btn subtitles" (click)="toggleSubtitles()">
                    <i class="fas fa-closed-captioning"></i>
                  </button>
                  <button class="control-btn volume" (click)="toggleMute()">
                    <i class="fas" [ngClass]="isMuted ? 'fa-volume-mute' : 'fa-volume-up'"></i>
                  </button>
                  <button class="control-btn fullscreen" (click)="toggleFullscreen()">
                    <i class="fas fa-expand"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Current Question Card -->
        <div class="question-card flip-in" [@flipIn] *ngIf="currentQuestion">
          <div class="flex justify-between items-start mb-6">
            <h2 class="text-xl font-semibold">Question {{ currentQuestionIndex + 1 }}: {{ currentQuestion.question }}</h2>
            <span class="bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded">2 points</span>
          </div>
          <div class="space-y-3">
            <div *ngFor="let option of currentQuestion.options; let i = index" class="option-item" [ngClass]="{
                'selected': selectedOptionIndex === i,
                'correct': showFeedback && option.correct,
                'incorrect': showFeedback && selectedOptionIndex === i && !option.correct
              }" (click)="selectOption(i)">
              <div class="flex items-center">
                <div class="flex-shrink-0 w-6 h-6 rounded-full border-2 border-gray-400 mr-3 flex items-center justify-center">
                  <span class="text-xs">{{ String.fromCharCode(65 + i) }}</span>
                </div>
                <div>
                  <pre class="text-sm"><code>{{ option.text }}</code></pre>
                </div>
              </div>
            </div>
          </div>
          <div class="flex justify-between mt-8">
            <button class="bg-gray-700 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition-colors flex items-center" (click)="previousQuestion()" [disabled]="currentQuestionIndex === 0">
              <i class="fas fa-arrow-left mr-2"></i> Question précédente
            </button>
            <button class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg transition-colors flex items-center" [ngClass]="{'opacity-50 cursor-not-allowed': selectedOptionIndex === null}" (click)="nextQuestion()">
              Question suivante <i class="fas fa-arrow-right ml-2"></i>
            </button>
          </div>
        </div>
        
        <!-- Quiz Progress -->
        <div class="mt-10">
          <h3 class="text-lg font-semibold mb-4">Progression du quiz</h3>
          <div class="flex space-x-2">
            <div *ngFor="let question of questions; let i = index" class="h-2 flex-1 bg-gray-700 rounded-full overflow-hidden">
              <div class="h-full" [ngClass]="{
                'bg-green-500': questionAnswered[i] && questionAnswered[i].correct,
                'bg-blue-500': i === currentQuestionIndex && !questionAnswered[i],
                'bg-red-500': questionAnswered[i] && !questionAnswered[i].correct
              }" [style.width]="questionAnswered[i] || i === currentQuestionIndex ? '100%' : '0%'"></div>
            </div>
          </div>
          <div class="flex justify-between text-xs text-gray-400 mt-2">
            <span *ngFor="let question of questions; let i = index">Question {{ i + 1 }}</span>
          </div>
        </div>
        
        <!-- Quiz Popup -->
        <div class="quiz-popup" [ngClass]="{'active': isQuizPopupOpen}" [@fadeIn] *ngIf="popupQuestion">
          <div class="quiz-timer" [style.transform]="'scaleX(' + (quizTimer / 30) + ')'"></div>
          <div class="py-4">
            <h3 class="text-xl font-bold mb-4">Question {{ popupQuestionIndex + 1 }}: {{ popupQuestion.question }}</h3>
            <div class="space-y-3">
              <div *ngFor="let option of popupQuestion.options; let i = index" class="option-item" [ngClass]="{'selected': popupSelectedOptionIndex === i}" (click)="selectPopupOption(i)">
                <div class="flex items-center">
                  <div class="flex-shrink-0 w-6 h-6 rounded-full border-2 border-gray-400 mr-3 flex items-center justify-center">
                    <span class="text-xs">{{ String.fromCharCode(65 + i) }}</span>
                  </div>
                  <div>{{ option.text }}</div>
                </div>
              </div>
            </div>
          </div>
          <div class="flex justify-end mt-4">
            <button class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg transition-colors" (click)="submitPopupAnswer()">Soumettre</button>
          </div>
        </div>
        
        <div class="quiz-overlay" [ngClass]="{'active': isQuizPopupOpen}" (click)="closeQuizPopup()"></div>
        
        <!-- Feedback Message -->
        <div class="quiz-feedback" [ngClass]="{'show': showFeedback, 'correct': feedbackCorrect, 'incorrect': !feedbackCorrect}" [@fadeInUp] *ngIf="feedbackMessage">
          <div class="flex items-center">
            <i class="fas" [ngClass]="feedbackCorrect ? 'fa-check-circle' : 'fa-times-circle'" class="mr-2"></i>
            <span>{{ feedbackMessage }}</span>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>